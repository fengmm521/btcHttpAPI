#!/usr/bin/env python# -*- coding: utf-8 -*-import sys,osimport httplibimport timeimport tradeMangerimport urllib2 import timetoolhttpClient = Nonetradetool = tradeManger.TradeManger() #btcc:https://data.btcchina.com/data/ticker?market=ltccnydef getTicker():    try:        req = urllib2.Request('https://data.btcchina.com/data/ticker?market=ltccny')        req.add_header('User-agent', 'Mozilla 5.10')        res = urllib2.urlopen(req)        html = res.read()        return html    except Exception, e:        print e    finally:        if httpClient:            httpClient.close()    return 0def main():    timeouttimes = 0    htmltimes = 0    while True:        tickertmp = getTicker()        print tickertmp        if tickertmp == 0:            timeouttimes += 1            f = open('timeoutlog.txt','a+')            savestr = 'timeout->times:' + str(timeouttimes) + ',time:' + str(timetool.getNowDate()) + '\n'            f.write(savestr)            f.close()            time.sleep(15)        elif tickertmp.find('<html>') != -1:            htmltimes += 1            f = open('htmllog.txt','a+')            savestr = 'htmlout->times:' + str(htmltimes) + ',time:' + str(timetool.getNowDate()) + '\n'            f.write(savestr)            f.close()            time.sleep(15)        else:            fname = timetool.getDateDay() + '.txt'            f = open(fname,'a+')            savedat = str(time.time()) + '=' + tickertmp + '\n'            tradetool.addTicker(savedat)            f.write(savedat)            f.close()            time.sleep(30)if __name__ == '__main__':    main()